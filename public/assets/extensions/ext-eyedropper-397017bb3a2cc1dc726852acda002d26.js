/*
 * ext-eyedropper.js
 *
 * Licensed under the MIT License
 *
 * Copyright(c) 2010 Jeff Schiller
 *
 */
svgEditor.addExtension("eyedropper",function(t){function e(t){var e=i.getMode();if("eyedropper"!=e){var n=null,a=$("#tool_eyedropper");!t.multiselected&&t.elems[0]&&-1==$.inArray(t.elems[0].nodeName,["svg","g","use"])?(n=t.elems[0],a.removeClass("disabled"),s.fillPaint=n.getAttribute("fill")||"black",s.fillOpacity=n.getAttribute("fill-opacity")||1,s.strokePaint=n.getAttribute("stroke"),s.strokeOpacity=n.getAttribute("stroke-opacity")||1,s.strokeWidth=n.getAttribute("stroke-width"),s.strokeDashArray=n.getAttribute("stroke-dasharray"),s.strokeLinecap=n.getAttribute("stroke-linecap"),s.strokeLinejoin=n.getAttribute("stroke-linejoin"),s.opacity=n.getAttribute("opacity")||1):a.addClass("disabled")}}var i=(t.svgcontent,t.svgroot.parentNode.ownerDocument,svgEditor.canvas),n=svgedit.history.ChangeElementCommand,a=function(t){i.undoMgr.addCommandToHistory(t)},s={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"};return{name:"eyedropper",svgicons:"/assets/extensions/eyedropper-icon.xml",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",key:"I",events:{click:function(){i.setMode("eyedropper")}}}],selectedChanged:e,elementChanged:e,mouseDown:function(t){var e=i.getMode();if("eyedropper"==e){var r=t.event,o=r.target;if(-1==$.inArray(o.nodeName,["svg","g","use"])){var l={},c=function(t,e,i){l[e]=t.getAttribute(e),t.setAttribute(e,i)};s.fillPaint&&c(o,"fill",s.fillPaint),s.fillOpacity&&c(o,"fill-opacity",s.fillOpacity),s.strokePaint&&c(o,"stroke",s.strokePaint),s.strokeOpacity&&c(o,"stroke-opacity",s.strokeOpacity),s.strokeWidth&&c(o,"stroke-width",s.strokeWidth),s.strokeDashArray&&c(o,"stroke-dasharray",s.strokeDashArray),s.opacity&&c(o,"opacity",s.opacity),s.strokeLinecap&&c(o,"stroke-linecap",s.strokeLinecap),s.strokeLinejoin&&c(o,"stroke-linejoin",s.strokeLinejoin),a(new n(o,l))}}}}});